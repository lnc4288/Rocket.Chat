{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:push-notifications/server/methods/saveNotificationSettings.js","meteor://ðŸ’»app/packages/rocketchat:push-notifications/server/models/Subscriptions.js"],"names":["Meteor","methods","saveNotificationSettings","rid","field","value","userId","Error","method","check","String","indexOf","subscription","RocketChat","models","Subscriptions","findOneByRoomIdAndUserId","updateAudioNotificationsById","_id","updateDesktopNotificationsById","updateMobilePushNotificationsById","updateEmailNotificationsById","updateUnreadAlertById","updateDisableNotificationsById","updateHideUnreadStatusById","saveAudioNotificationValue","updateAudioNotificationValueById","saveDesktopNotificationDuration","updateDesktopNotificationDurationById","audioNotifications","query","update","$unset","$set","audioNotificationValue","desktopNotifications","desktopNotificationDuration","parseInt","mobilePushNotifications","emailNotifications","unreadAlert","disableNotifications","hideUnreadStatus","findAlwaysNotifyAudioUsersByRoomId","roomId","find","findAlwaysNotifyDesktopUsersByRoomId","findDontNotifyDesktopUsersByRoomId","findAlwaysNotifyMobileUsersByRoomId","findDontNotifyMobileUsersByRoomId","findNotificationPreferencesByRoom","explicit","$exists","$or","fields","findWithSendEmailByRoomId","u"],"mappings":"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","file":"/packages/rocketchat_push-notifications.js","sourcesContent":["Meteor.methods({\n\tsaveNotificationSettings(rid, field, value) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tcheck(rid, String);\n\t\tcheck(field, String);\n\t\tcheck(value, String);\n\n\t\tif (['audioNotifications', 'desktopNotifications', 'mobilePushNotifications', 'emailNotifications', 'unreadAlert', 'disableNotifications', 'hideUnreadStatus'].indexOf(field) === -1) {\n\t\t\tthrow new Meteor.Error('error-invalid-settings', 'Invalid settings field', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tif (field !== 'hideUnreadStatus' && field !== 'disableNotifications' && ['all', 'mentions', 'nothing', 'default'].indexOf(value) === -1) {\n\t\t\tthrow new Meteor.Error('error-invalid-settings', 'Invalid settings value', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveNotificationSettings' });\n\t\t}\n\n\t\tswitch (field) {\n\t\t\tcase 'audioNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateAudioNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'desktopNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateDesktopNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'mobilePushNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateMobilePushNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'emailNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateEmailNotificationsById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'unreadAlert':\n\t\t\t\tRocketChat.models.Subscriptions.updateUnreadAlertById(subscription._id, value);\n\t\t\t\tbreak;\n\t\t\tcase 'disableNotifications':\n\t\t\t\tRocketChat.models.Subscriptions.updateDisableNotificationsById(subscription._id, value === '1' ? true : false);\n\t\t\t\tbreak;\n\t\t\tcase 'hideUnreadStatus':\n\t\t\t\tRocketChat.models.Subscriptions.updateHideUnreadStatusById(subscription._id, value === '1' ? true : false);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tsaveAudioNotificationValue(rid, value) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveAudioNotificationValue' });\n\t\t}\n\t\tRocketChat.models.Subscriptions.updateAudioNotificationValueById(subscription._id, value);\n\t\treturn true;\n\t},\n\n\tsaveDesktopNotificationDuration(rid, value) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-invalid-subscription', 'Invalid subscription', { method: 'saveDesktopNotificationDuration' });\n\t\t}\n\t\tRocketChat.models.Subscriptions.updateDesktopNotificationDurationById(subscription._id, value);\n\t\treturn true;\n\t}\n});\n","RocketChat.models.Subscriptions.updateAudioNotificationsById = function(_id, audioNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (audioNotifications === 'default') {\n\t\tupdate.$unset = { audioNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { audioNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateAudioNotificationValueById = function(_id, audioNotificationValue) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\taudioNotificationValue\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDesktopNotificationsById = function(_id, desktopNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (desktopNotifications === 'default') {\n\t\tupdate.$unset = { desktopNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { desktopNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDesktopNotificationDurationById = function(_id, value) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tdesktopNotificationDuration: parseInt(value)\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateMobilePushNotificationsById = function(_id, mobilePushNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {};\n\n\tif (mobilePushNotifications === 'default') {\n\t\tupdate.$unset = { mobilePushNotifications: 1 };\n\t} else {\n\t\tupdate.$set = { mobilePushNotifications };\n\t}\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateEmailNotificationsById = function(_id, emailNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\temailNotifications\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateUnreadAlertById = function(_id, unreadAlert) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tunreadAlert\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateDisableNotificationsById = function(_id, disableNotifications) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tdisableNotifications\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.updateHideUnreadStatusById = function(_id, hideUnreadStatus) {\n\tconst query = {\n\t\t_id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\thideUnreadStatus\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyAudioUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\taudioNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyDesktopUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tdesktopNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findDontNotifyDesktopUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tdesktopNotifications: 'nothing'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findAlwaysNotifyMobileUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tmobilePushNotifications: 'all'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findDontNotifyMobileUsersByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\tmobilePushNotifications: 'nothing'\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Subscriptions.findNotificationPreferencesByRoom = function(roomId, explicit) {\n\tconst query = {\n\t\trid: roomId,\n\t\t'u._id': {$exists: true}\n\t};\n\n\tif (explicit) {\n\t\tquery.$or = [\n\t\t\t{audioNotifications: {$exists: true}},\n\t\t\t{audioNotificationValue: {$exists: true}},\n\t\t\t{desktopNotifications: {$exists: true}},\n\t\t\t{desktopNotificationDuration: {$exists: true}},\n\t\t\t{mobilePushNotifications: {$exists: true}},\n\t\t\t{disableNotifications: {$exists: true}}\n\t\t];\n\t}\n\n\treturn this.find(query, { fields: { 'u._id': 1, audioNotifications: 1, audioNotificationValue: 1, desktopNotificationDuration: 1, desktopNotifications: 1, mobilePushNotifications: 1, disableNotifications: 1 } });\n};\n\nRocketChat.models.Subscriptions.findWithSendEmailByRoomId = function(roomId) {\n\tconst query = {\n\t\trid: roomId,\n\t\temailNotifications: {\n\t\t\t$exists: true\n\t\t}\n\t};\n\n\treturn this.find(query, { fields: { emailNotifications: 1, u: 1 } });\n};\n"]}